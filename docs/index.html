<!DOCTYPE html><html class="default" lang="en" data-base="./"><head><meta charset="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>jsonaut</title><meta name="description" content="Documentation for jsonaut"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script><script async src="assets/hierarchy.js" id="tsd-hierarchy-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => window.app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><a href="index.html" class="title">jsonaut</a><div id="tsd-toolbar-links"></div><button id="tsd-search-trigger" class="tsd-widget" aria-label="Search"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-search"></use></svg></button><dialog id="tsd-search" aria-label="Search"><input role="combobox" id="tsd-search-input" aria-controls="tsd-search-results" aria-autocomplete="list" aria-expanded="true" autocapitalize="off" autocomplete="off" placeholder="Search the docs" maxLength="100"/><ul role="listbox" id="tsd-search-results"></ul><div id="tsd-search-status" aria-live="polite" aria-atomic="true"><div>Preparing search index...</div></div></dialog><a href="#" class="tsd-widget menu" id="tsd-toolbar-menu-trigger" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h1>jsonaut</h1></div><div class="tsd-panel tsd-typography"><p><img src="https://raw.githubusercontent.com/sithmel/jsonaut/main/logo/logo.png" alt="JSONaut logo"></p>
<p>JSONaut allows to work with JSON as streams, without the need to load them in memory.
It converts them into a sequence of path/value pairs (using iterables) and offers a lot of features to manipulate that sequence and returns it as object or as a new stream.</p>
<p>It is minimal (only 1 small dependency) but works well with other libraries. It is designed for both server and client.</p>
<h2 id="index" class="tsd-anchor-link">Index<a href="#index" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><ul>
<li><a href="#examples">Examples</a></li>
<li><a href="#main-concepts">Main concepts</a></li>
<li><a href="#functions-and-classes">Functions and Classes</a></li>
<li><a href="#benchmarks">Benchmarks</a></li>
</ul>
<h2 id="examples" class="tsd-anchor-link">Examples<a href="#examples" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="parsing-a-subset-of-a-json" class="tsd-anchor-link">Parsing a subset of a JSON<a href="#parsing-a-subset-of-a-json" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>You can filter a stream to build an object that contains only the data required. See the <a href="#benchmarks">benchmarks</a>.</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;fs&quot;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">streamToIterable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-3">&quot;invoices.json&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">obj</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">includes</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">`</span><br/><span class="hl-3">    &#39;invoices&#39; (</span><br/><span class="hl-3">      0..2 (</span><br/><span class="hl-3">        # only these fields from the first 2 invoices</span><br/><span class="hl-3">        &#39;productName&#39;</span><br/><span class="hl-3">        &#39;itemsSold&#39;</span><br/><span class="hl-3">        &#39;unitPrice&#39;</span><br/><span class="hl-3">      )</span><br/><span class="hl-3">    )</span><br/><span class="hl-3">  `</span><span class="hl-1">,</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  .</span><span class="hl-6">toObject</span><span class="hl-1">() </span><span class="hl-7">// consumes the stream and transforms to an object</span><br/><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">obj</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>This prints:</p>
<pre><code class="js"><span class="hl-1">{</span><br/><span class="hl-1">  ;[</span><br/><span class="hl-1">    { </span><span class="hl-2">productName:</span><span class="hl-1"> </span><span class="hl-3">&quot;Bright copper kettles&quot;</span><span class="hl-1">, </span><span class="hl-2">itemSold:</span><span class="hl-1"> </span><span class="hl-8">12</span><span class="hl-1">, </span><span class="hl-2">unitPrice:</span><span class="hl-1"> </span><span class="hl-8">11.4</span><span class="hl-1"> },</span><br/><span class="hl-1">    { </span><span class="hl-2">productName:</span><span class="hl-1"> </span><span class="hl-3">&quot;Warm woolen mittens&quot;</span><span class="hl-1">, </span><span class="hl-2">itemSold:</span><span class="hl-1"> </span><span class="hl-8">13</span><span class="hl-1">, </span><span class="hl-2">unitPrice:</span><span class="hl-1"> </span><span class="hl-8">1.44</span><span class="hl-1"> },</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="filtering-a-json-stream" class="tsd-anchor-link">Filtering a JSON stream<a href="#filtering-a-json-stream" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is the same example but it writes to a stream without deserialising the JSON:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;fs&quot;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">streamToIterable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-2">inputFilePath</span><span class="hl-1">)</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">writeStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createWriteStream</span><span class="hl-1">(</span><span class="hl-2">outputFilePath</span><span class="hl-1">)</span><br/><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">`&#39;invoices&#39;( 0..2( &#39;productName&#39; &#39;itemsSold&#39; &#39;unitPrice&#39;))`</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">toIterableBuffer</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-6">forEach</span><span class="hl-1">((</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">writeStream</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">)</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-2">writeStream</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">()</span><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h3 id="transform-json-stream" class="tsd-anchor-link">Transform JSON stream<a href="#transform-json-stream" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is using filter and map to modify the data stream. It also uses reduce to aggregate the data. This is done without deserialising the entire object in memory:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;fs&quot;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">streamToIterable</span><span class="hl-1">, </span><span class="hl-2">toValueObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-2">inputFilePath</span><span class="hl-1">)</span><br/><br/><span class="hl-7">// filter and map modify the iterable without consuming it</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">mostSuccessfulProducts</span><span class="hl-1"> = </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">, { </span><span class="hl-2">maxDepth:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1"> })</span><br/><span class="hl-1">  .</span><span class="hl-6">filter</span><span class="hl-1">(([</span><span class="hl-2">_pathObj</span><span class="hl-1">, </span><span class="hl-2">valueObj</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">valueObj</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">.</span><span class="hl-2">itemsSold</span><span class="hl-1"> &gt;= </span><span class="hl-8">1000</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-6">map</span><span class="hl-1">(([</span><span class="hl-2">pathObj</span><span class="hl-1">, </span><span class="hl-2">valueObj</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">value</span><span class="hl-1"> = </span><span class="hl-2">valueObj</span><span class="hl-1">.</span><span class="hl-2">decoded</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">pathObj</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">toValueObject</span><span class="hl-1">({ ...</span><span class="hl-2">value</span><span class="hl-1">, </span><span class="hl-2">total:</span><span class="hl-1"> </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">itemsSold</span><span class="hl-1"> * </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">unitPrice</span><span class="hl-1"> }),</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;Revenues for most successful products&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">totalRevenues</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">mostSuccessfulProducts</span><span class="hl-1">.</span><span class="hl-6">reduce</span><span class="hl-1">(</span><br/><span class="hl-1">  (</span><span class="hl-2">acc</span><span class="hl-1">, [</span><span class="hl-2">_path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-5">productName</span><span class="hl-1">, </span><span class="hl-5">total</span><span class="hl-1"> } = </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">`Product &quot;</span><span class="hl-4">${</span><span class="hl-2">productName</span><span class="hl-4">}</span><span class="hl-3">&quot; revenues: </span><span class="hl-4">${</span><span class="hl-2">total</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">acc</span><span class="hl-1"> + </span><span class="hl-2">total</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-8">0</span><span class="hl-1">,</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-3">&quot;Total:&quot;</span><span class="hl-1">, </span><span class="hl-2">totalRevenues</span><span class="hl-1">)</span><br/><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h3 id="rendering-partial-state" class="tsd-anchor-link">Rendering partial state<a href="#rendering-partial-state" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This is rendering the UI while a big JSON with the data is being fetched.</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">streamToIterable</span><span class="hl-1">, </span><span class="hl-2">SequenceToObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-7">// this will rebuild the object from a sequence</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">objectBuilder</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">SequenceToObject</span><span class="hl-1">()</span><br/><br/><span class="hl-7">// fetch can be aborted</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">controller</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">AbortController</span><span class="hl-1">()</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">signal</span><span class="hl-1"> = </span><span class="hl-2">controller</span><span class="hl-1">.</span><span class="hl-2">signal</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">response</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">fetch</span><span class="hl-1">(</span><span class="hl-2">url</span><span class="hl-1">, { </span><span class="hl-2">signal</span><span class="hl-1"> })</span><br/><br/><span class="hl-7">// iter is an asyncIterable of iterables (see BatchIterable)</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">iter</span><span class="hl-1"> = </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">body</span><span class="hl-1">)</span><br/><br/><span class="hl-0">for</span><span class="hl-1"> </span><span class="hl-0">await</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">iterables</span><span class="hl-1"> </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">iter</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-7">// this adds to the object the chunk of sequence I could read so far</span><br/><span class="hl-1">  </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">path</span><span class="hl-1">, </span><span class="hl-5">value</span><span class="hl-1">] </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">iterables</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">objectBuilder</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-7">// I can now render the object containing the data I fetched so far</span><br/><span class="hl-1">  </span><span class="hl-7">// &quot;render&quot; is left to implement</span><br/><span class="hl-1">  </span><span class="hl-6">render</span><span class="hl-1">(</span><span class="hl-2">objectBuilder</span><span class="hl-1">.</span><span class="hl-6">getObject</span><span class="hl-1">())</span><br/><span class="hl-1">  </span><span class="hl-7">// I can decide to stop fetching and parsing the stream using abort</span><br/><span class="hl-1">  </span><span class="hl-7">// &quot;shouldStop&quot; is left to implement</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-6">shouldStop</span><span class="hl-1">()) {</span><br/><span class="hl-1">    </span><span class="hl-2">controller</span><span class="hl-1">.</span><span class="hl-6">abort</span><span class="hl-1">()</span><br/><span class="hl-1">    </span><span class="hl-0">break</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h3 id="index-a-json-and-load-a-json-fragment" class="tsd-anchor-link">Index a JSON and load a JSON fragment<a href="#index-a-json-and-load-a-json-fragment" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Let's assume we have a JSON containing a list of objects:</p>
<pre><code class="json"><span class="hl-1">[</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;created_at&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;Mon, 19 Dec 2011 18:56:59 +0000&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;from_user&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;edjoperez&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;text&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;I have to tell you: There is a project to create GTK bindings to #Nodejs, can you imagine javascript in a desktop GUI application? :D&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  {</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;created_at&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;Mon, 19 Dec 2011 18:54:27 +0000&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;from_user&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;donnfelker&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;text&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;My last 3 days  - Android. Python. NodeJs. MongoDB. MySql. Sqlite. Json. Html. JavaScript. Django.&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-10">...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-10">...</span><br/><span class="hl-1">]</span>
</code><button type="button">Copy</button></pre>

<p>This function creates an JSON containing the indeces of the various objects:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;fs&quot;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">path</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;path&quot;</span><br/><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">streamToIterable</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-6">createIndex</span><span class="hl-1">(</span><span class="hl-2">JSONPath</span><span class="hl-1">, </span><span class="hl-2">indexPath</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-2">JSONPath</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">indexObj</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">, { </span><span class="hl-2">maxDepth:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> }).</span><span class="hl-6">reduce</span><span class="hl-1">(</span><br/><span class="hl-1">    (</span><span class="hl-2">builder</span><span class="hl-1">, [</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">_value</span><span class="hl-1">, </span><span class="hl-2">start</span><span class="hl-1">, </span><span class="hl-2">end</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-0">if</span><span class="hl-1"> (</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> === </span><span class="hl-8">1</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-2">builder</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, [</span><span class="hl-2">start</span><span class="hl-1">, </span><span class="hl-2">end</span><span class="hl-1">])</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">builder</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">    </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">SequenceToObject</span><span class="hl-1">(),</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">  </span><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">writeFileSync</span><span class="hl-1">(</span><span class="hl-2">indexPath</span><span class="hl-1">, </span><span class="hl-5">JSON</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-2">indexObj</span><span class="hl-1">.</span><span class="hl-2">object</span><span class="hl-1">))</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Like this:</p>
<pre><code class="json"><span class="hl-1">[</span><br/><span class="hl-1">  [</span><span class="hl-8">4</span><span class="hl-1">, </span><span class="hl-8">899</span><span class="hl-1">],</span><br/><span class="hl-1">  [</span><span class="hl-8">903</span><span class="hl-1">, </span><span class="hl-8">1819</span><span class="hl-1">],</span><br/><span class="hl-1">  </span><span class="hl-10">...</span><br/><span class="hl-1">]</span>
</code><button type="button">Copy</button></pre>

<p>Then the object can be read like this:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1"> </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;fs/promises&quot;</span><br/><br/><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-6">filterFile</span><span class="hl-1">(</span><span class="hl-2">JSONPath</span><span class="hl-1">, </span><span class="hl-2">indexPath</span><span class="hl-1">, </span><span class="hl-2">lineNumber</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">indexReadStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-2">indexPath</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">obj</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">indexReadStream</span><span class="hl-1">, { </span><span class="hl-2">maxDepth:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> })</span><br/><span class="hl-1">    .</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-2">lineNumber</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-6">toObject</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">start</span><span class="hl-1">, </span><span class="hl-5">end</span><span class="hl-1">] = </span><span class="hl-2">obj</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">]</span><br/><span class="hl-1">  </span><span class="hl-7">// once I found the indeces I need, I can stop reading the stream</span><br/><span class="hl-1">  </span><span class="hl-2">indexReadStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">str</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">readFile</span><span class="hl-1">(</span><span class="hl-2">JSONPath</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">start</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">end:</span><span class="hl-1"> </span><span class="hl-2">end</span><span class="hl-1"> - </span><span class="hl-8">1</span><span class="hl-1">,</span><br/><span class="hl-1">    </span><span class="hl-2">encoding:</span><span class="hl-1"> </span><span class="hl-3">&quot;utf-8&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">data</span><span class="hl-1"> = </span><span class="hl-5">JSON</span><span class="hl-1">.</span><span class="hl-6">parse</span><span class="hl-1">(</span><span class="hl-2">str</span><span class="hl-1">)</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">data</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>On the browser we can implement the equivalent using HTTP range requests:</p>
<pre><code class="js"><span class="hl-4">async</span><span class="hl-1"> </span><span class="hl-4">function</span><span class="hl-1"> </span><span class="hl-6">filterFile</span><span class="hl-1">(</span><span class="hl-2">JSONURL</span><span class="hl-1">, </span><span class="hl-2">indexURL</span><span class="hl-1">, </span><span class="hl-2">lineNumber</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">controller</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">AbortController</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">signal</span><span class="hl-1"> = </span><span class="hl-2">controller</span><span class="hl-1">.</span><span class="hl-2">signal</span><br/><br/><span class="hl-1">  </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-2">responseIndex</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">fetch</span><span class="hl-1">(</span><span class="hl-2">indexURL</span><span class="hl-1">, { </span><span class="hl-2">signal</span><span class="hl-1"> })</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">indexReadStream</span><span class="hl-1"> = </span><span class="hl-2">responseIndex</span><span class="hl-1">.</span><span class="hl-2">body</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">obj</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">indexReadStream</span><span class="hl-1">, { </span><span class="hl-2">maxDepth:</span><span class="hl-1"> </span><span class="hl-8">1</span><span class="hl-1"> })</span><br/><span class="hl-1">    .</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">`</span><span class="hl-4">${</span><span class="hl-2">lineNumber</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)</span><br/><span class="hl-1">    .</span><span class="hl-6">toObject</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-7">// once I found the indeces I need, I can stop reading the stream</span><br/><span class="hl-1">  </span><span class="hl-2">controller</span><span class="hl-1">.</span><span class="hl-6">abort</span><span class="hl-1">()</span><br/><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">start</span><span class="hl-1">, </span><span class="hl-5">end</span><span class="hl-1">] = </span><span class="hl-2">obj</span><span class="hl-1">[</span><span class="hl-8">0</span><span class="hl-1">]</span><br/><br/><span class="hl-1">  </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-2">responseJSON</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">fetch</span><span class="hl-1">(</span><span class="hl-2">filename</span><span class="hl-1">, {</span><br/><span class="hl-1">    </span><span class="hl-2">headers:</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-2">Range:</span><span class="hl-1"> </span><span class="hl-3">`bytes=</span><span class="hl-4">${</span><span class="hl-2">start</span><span class="hl-4">}</span><span class="hl-3">-</span><span class="hl-4">${</span><span class="hl-2">end</span><span class="hl-11"> </span><span class="hl-1">-</span><span class="hl-11"> </span><span class="hl-8">1</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">,</span><br/><span class="hl-1">    },</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  </span><span class="hl-0">if</span><span class="hl-1"> (!</span><span class="hl-2">responseJSON</span><span class="hl-1">.</span><span class="hl-2">ok</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-0">throw</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Error</span><span class="hl-1">(</span><span class="hl-3">`HTTP error! status: </span><span class="hl-4">${</span><span class="hl-2">responseJSON</span><span class="hl-11">.</span><span class="hl-2">status</span><span class="hl-4">}</span><span class="hl-3">`</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">  </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">json</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-2">responseJSON</span><span class="hl-1">.</span><span class="hl-6">json</span><span class="hl-1">()</span><br/><span class="hl-1">  </span><span class="hl-0">return</span><span class="hl-1"> </span><span class="hl-2">json</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<h1 id="main-concepts" class="tsd-anchor-link">Main concepts<a href="#main-concepts" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="path-value" class="tsd-anchor-link">Path, Value<a href="#path-value" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The main idea behind this library is that a JSON can be converted into a sequence of &quot;path, value&quot; pairs and can be reconstructed from this sequence.
This allows to filter and transform a big JSON as a stream, without having to load it in memory.</p>
<p>An example of a sequence is:</p>
<table>
<thead>
<tr>
<th>Path, Value</th>
<th>Resulting object</th>
</tr>
</thead>
<tbody>
<tr>
<td>[&quot;name&quot;], &quot;JSONaut&quot;</td>
<td>{&quot;name&quot;: &quot;JSONaut&quot;}</td>
</tr>
<tr>
<td>[&quot;keywords&quot;, 0], &quot;json&quot;</td>
<td>{&quot;name&quot;: &quot;JSONaut&quot;, keywords: [&quot;json&quot;]}</td>
</tr>
<tr>
<td>[&quot;keywords&quot;, 1], &quot;stream&quot;</td>
<td>{&quot;name&quot;: &quot;JSONaut&quot;, keywords: [&quot;json&quot;, &quot;stream&quot;]}</td>
</tr>
</tbody>
</table>
<h2 id="batchiterable" class="tsd-anchor-link">BatchIterable<a href="#batchiterable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>A JSON stream can be read as <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/AsyncIterator">asyncIterable</a>. Every chunk of the stream is a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Uint8Array">typed array</a>. Once parsed it yields <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Iterators_and_generators">iterables</a> of path/value pairs. For this reason, the sequence can be typed as <code>AsyncIterable&lt;Iterable&lt;[Path, Value]&gt;&gt;</code>.
I call <code>AsyncIterable&lt;Iterable&lt;T&gt;&gt;</code> a <code>BatchIterable&lt;T&gt;</code> for short.
Javascript makes unwieldy to work with a type defined like that. It basically requires a nested for loop like this one:</p>
<pre><code class="js"><span class="hl-0">for</span><span class="hl-1"> </span><span class="hl-0">await</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">iterables</span><span class="hl-1"> </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">asyncIter</span><span class="hl-1">) {</span><br/><span class="hl-1">  </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">path</span><span class="hl-1">, </span><span class="hl-5">value</span><span class="hl-1">] </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">iterables</span><span class="hl-1">) {</span><br/><span class="hl-1">    ...</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>Treating synchronous iterables like async ones would have only penalised the performance.</p>
<p>For this reason I have abstracted this type in a class that offers some standard way to manipulate the sequence.
You can find the <a href="https://github.com/sithmel/batch-iterable">documentation here</a>.</p>
<h2 id="path-and-value-encodingdecoding" class="tsd-anchor-link">Path and Value encoding/decoding<a href="#path-and-value-encodingdecoding" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="json-values" class="tsd-anchor-link">JSON Values<a href="#json-values" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>While building this library I noticed that most of the computation time goes into decoding arrayBuffers to a Javascript strings and deserialising them to js values. To keep the performance at a reasonable level, the library avoids decoding and parsing strings unless is strictly necessary.
This can be done using a set of classes that are storing the data as a buffer and they are decoding the data (and caching it) on demand.</p>
<p>Here is an example:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">False</span><span class="hl-1">, </span><span class="hl-2">CachedString</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">falseValue</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">False</span><span class="hl-1">()</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">helloValue</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">CachedString</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">Uint8Array</span><span class="hl-1">([</span><span class="hl-8">34</span><span class="hl-1">, </span><span class="hl-8">104</span><span class="hl-1">, </span><span class="hl-8">101</span><span class="hl-1">, </span><span class="hl-8">108</span><span class="hl-1">, </span><span class="hl-8">108</span><span class="hl-1">, </span><span class="hl-8">111</span><span class="hl-1">, </span><span class="hl-8">34</span><span class="hl-1">]),</span><br/><span class="hl-1">)</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">falseValue</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">) </span><span class="hl-7">// false</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">falseValue</span><span class="hl-1">.</span><span class="hl-2">encoded</span><span class="hl-1">) </span><span class="hl-7">// false as Uint8Array encoded string</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">helloValue</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">) </span><span class="hl-7">// the &quot;hello&quot; javascript string</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">helloValue</span><span class="hl-1">.</span><span class="hl-2">encoded</span><span class="hl-1">) </span><span class="hl-7">// Uint8Array(7)[34, 104, 101, 108, 108, 111, 34]</span>
</code><button type="button">Copy</button></pre>

<p>These object have a method to check for equality without decoding the string:</p>
<pre><code class="js"><span class="hl-2">falseValue</span><span class="hl-1">.</span><span class="hl-6">isEqual</span><span class="hl-1">(</span><span class="hl-2">helloValue</span><span class="hl-1">) </span><span class="hl-7">// false</span><br/><span class="hl-2">helloValue</span><span class="hl-1">.</span><span class="hl-6">isEqual</span><span class="hl-1">(</span><span class="hl-2">helloValue</span><span class="hl-1">) </span><span class="hl-7">// true</span>
</code><button type="button">Copy</button></pre>

<p>The value objects are:</p>
<ul>
<li>True</li>
<li>False</li>
<li>Null</li>
<li>CachedString</li>
<li>CachedNumber</li>
<li>CachedSubObject</li>
</ul>
<p><code>toValueObject</code> is a function that converts a valid Javascript value into one of these objects:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">toValueObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">helloValue</span><span class="hl-1"> = </span><span class="hl-6">toValueObject</span><span class="hl-1">(</span><span class="hl-3">&quot;hello&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">helloValue</span><span class="hl-1"> </span><span class="hl-4">instanceof</span><span class="hl-1"> </span><span class="hl-12">CachedString</span><span class="hl-1">) </span><span class="hl-7">// true</span>
</code><button type="button">Copy</button></pre>

<p><strong>Note</strong>: The buffer stored contains the JSON representation of the Javascript value. So in the case of strings it includes double quotes and escapes.</p>
<h3 id="json-path" class="tsd-anchor-link">JSON Path<a href="#json-path" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>Paths contains both string and numbers. Strings are also encoded using CachedString. Path are converted in encoded format using <code>toPathObject</code></p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">toPathObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">path</span><span class="hl-1"> = </span><span class="hl-6">toPathObject</span><span class="hl-1">([</span><span class="hl-3">&quot;hello&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;world&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">])</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1">) </span><span class="hl-7">// 3</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">encoded</span><span class="hl-1">) </span><span class="hl-7">// [Uint8Array, UintArray, 0]</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">) </span><span class="hl-7">// [&#39;hello&#39;, &#39;world&#39;, 0]</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">)) </span><span class="hl-7">// CachedString</span><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-8">0</span><span class="hl-1">).</span><span class="hl-2">decoded</span><span class="hl-1">) </span><span class="hl-7">// &quot;hello&quot;</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">get</span><span class="hl-1">(</span><span class="hl-8">2</span><span class="hl-1">)) </span><span class="hl-7">// 0</span>
</code><button type="button">Copy</button></pre>

<p>Path objects contain some extra utility functions:</p>
<pre><code class="js"><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">isEqual</span><span class="hl-1">(</span><span class="hl-2">otherPath</span><span class="hl-1">) </span><span class="hl-7">// true if the 2 paths are identical</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">index</span><span class="hl-1"> = </span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">getCommonPathIndex</span><span class="hl-1">(</span><span class="hl-2">otherPath</span><span class="hl-1">)</span><br/><span class="hl-7">// returns the index of where the path segments are different.</span><br/><span class="hl-7">// For example:</span><br/><span class="hl-7">// index === 0  paths are entirely different</span><br/><span class="hl-7">// index === path.length path is contained into otherPath</span><br/><span class="hl-7">// index === otherPath.length otherPath is contained into path</span>
</code><button type="button">Copy</button></pre>

<h3 id="how-to-use-it" class="tsd-anchor-link">How to use it<a href="#how-to-use-it" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><pre><code class="js"><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">map</span><span class="hl-1">(([</span><span class="hl-2">pathObj</span><span class="hl-1">, </span><span class="hl-2">valueObj</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">value</span><span class="hl-1"> = </span><span class="hl-2">valueObj</span><span class="hl-1">.</span><span class="hl-2">decoded</span><br/><span class="hl-1">    </span><span class="hl-0">return</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-2">pathObj</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">toValueObject</span><span class="hl-1">({ ...</span><span class="hl-2">value</span><span class="hl-1">, </span><span class="hl-2">total:</span><span class="hl-1"> </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">itemsSold</span><span class="hl-1"> * </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">unitPrice</span><span class="hl-1"> }),</span><br/><span class="hl-1">    ]</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-6">filter</span><span class="hl-1">(([</span><span class="hl-2">_pathObj</span><span class="hl-1">, </span><span class="hl-2">valueObj</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">valueObj</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">.</span><span class="hl-2">total</span><span class="hl-1"> &gt;= </span><span class="hl-8">1000</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>Just remember that decoding always comes with a performance penalty. So, when possible, use encoded buffer or use methods working with buffers (isEqual, getCommonPathIndex)
The performance penalty is only paid once though. Once a value is decoded, it is cached.</p>
<h1 id="functions-and-classes" class="tsd-anchor-link">Functions and Classes<a href="#functions-and-classes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><h2 id="streamtoiterable" class="tsd-anchor-link">streamToIterable<a href="#streamtoiterable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This function takes a asyncIterable of buffers as input. This is the return value of Node.js and Web Streams:</p>
<pre><code class="js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-3">&quot;invoices.json&quot;</span><span class="hl-1">)</span><br/><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>or</p>
<pre><code class="js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">response</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">fetch</span><span class="hl-1">(</span><span class="hl-2">url</span><span class="hl-1">)</span><br/><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">response</span><span class="hl-1">.</span><span class="hl-2">body</span><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>The object returned is a batchIterable that it can be consumed like this:</p>
<pre><code class="js"><span class="hl-0">for</span><span class="hl-1"> </span><span class="hl-0">await</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">iterables</span><span class="hl-1"> </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)) {</span><br/><span class="hl-1">  </span><span class="hl-0">for</span><span class="hl-1"> (</span><span class="hl-4">const</span><span class="hl-1"> [</span><span class="hl-5">path</span><span class="hl-1">, </span><span class="hl-5">value</span><span class="hl-1">] </span><span class="hl-4">of</span><span class="hl-1"> </span><span class="hl-2">iterables</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">)</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>It also supports all the methods listed <a href="https://github.com/sithmel/batch-iterable">here</a>. So it can also be consumed like this:</p>
<pre><code class="js"><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">).</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">),</span><br/><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>Let's assume we are working with the following JSON:</p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-9">&quot;invoices&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">    {</span><span class="hl-9">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;piano catapult&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">40</span><span class="hl-1">, </span><span class="hl-9">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">120</span><span class="hl-1">},</span><br/><span class="hl-1">    {</span><span class="hl-9">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;fake tunnel&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">12</span><span class="hl-1">, </span><span class="hl-9">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">220</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-10">...</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>The previous examples will return:</p>
<pre><code class="js"><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-2">productName</span><span class="hl-1">] </span><span class="hl-3">&quot;piano catapult&quot;</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-2">itemsSold</span><span class="hl-1">] </span><span class="hl-8">40</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-2">unitPrice</span><span class="hl-1">] </span><span class="hl-8">120</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-2">productName</span><span class="hl-1">] </span><span class="hl-3">&quot;fake tunnel&quot;</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-2">itemsSold</span><span class="hl-1">] </span><span class="hl-8">12</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-2">unitPrice</span><span class="hl-1">] </span><span class="hl-8">220</span><br/><span class="hl-1">...</span>
</code><button type="button">Copy</button></pre>

<p>Note: <em>There is an extremely rare corner case where the parser doesn't work as expected: when a json consists in a <strong>single number and no trailing spaces</strong>. In that case it is necessary to add a trailing space to make it work correctly!</em></p>
<h3 id="maxdepth-and-ismaxdepthreached" class="tsd-anchor-link">maxDepth and isMaxDepthReached<a href="#maxdepth-and-ismaxdepthreached" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>In some cases you would like to group more values together. You can do this limiting the depth of the parsing:</p>
<pre><code class="js"><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">, { </span><span class="hl-2">maxDepth:</span><span class="hl-1"> </span><span class="hl-8">2</span><span class="hl-1"> }).</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">),</span><br/><span class="hl-1">)</span>
</code><button type="button">Copy</button></pre>

<p>Which it returns:</p>
<pre><code class="js"><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">] {</span><span class="hl-3">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;piano catapult&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">40</span><span class="hl-1">, </span><span class="hl-3">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">120</span><span class="hl-1">}</span><br/><span class="hl-1">[</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">] {</span><span class="hl-3">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;fake tunnel&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">12</span><span class="hl-1">, </span><span class="hl-3">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">220</span><span class="hl-1">}</span><br/><span class="hl-1">...</span>
</code><button type="button">Copy</button></pre>

<p>Rather than using a fixed maxDepth you can decide whether to limit the parsing based on the current path:</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">toPathObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">invoicesPath</span><span class="hl-1"> = </span><span class="hl-6">toPathObject</span><span class="hl-1">([</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">])</span><br/><br/><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-6">isMaxDepthReached</span><span class="hl-2">:</span><span class="hl-1"> (</span><span class="hl-2">path</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><br/><span class="hl-1">    </span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-6">getCommonPathIndex</span><span class="hl-1">(</span><span class="hl-2">invoicesPath</span><span class="hl-1">) === </span><span class="hl-8">1</span><span class="hl-1"> &amp;&amp; </span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">length</span><span class="hl-1"> === </span><span class="hl-8">2</span><span class="hl-1">,</span><br/><span class="hl-1">}).</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">))</span>
</code><button type="button">Copy</button></pre>

<p>Note: Limiting the depth of parsing is also a way to increase the performance.</p>
<h3 id="transform-the-sequence" class="tsd-anchor-link">Transform the sequence<a href="#transform-the-sequence" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>You can reconstruct an object out of a sequence using <code>toObject</code>.</p>
<pre><code class="js"><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">obj</span><span class="hl-1"> = </span><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">).</span><span class="hl-6">toObject</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<p>Or return a <code>BatchIterable&lt;Uint8Array&gt;</code> to transform the sequence back to a stream.</p>
<pre><code class="js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">toIterableBuffer</span><span class="hl-1">()</span><br/><span class="hl-1">  .</span><span class="hl-6">forEach</span><span class="hl-1">((</span><span class="hl-2">data</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">writeStream</span><span class="hl-1">.</span><span class="hl-6">write</span><span class="hl-1">(</span><span class="hl-2">data</span><span class="hl-1">)</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-2">writeStream</span><span class="hl-1">.</span><span class="hl-6">end</span><span class="hl-1">()</span><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<p>In building an object or streaming it out you have to consider 2 important caveats:</p>
<ul>
<li>Streaming out JSON requires the &quot;path, value&quot; pairs to be emitted in <strong>depth first</strong> order of paths otherwise the resulting JSON will be malformed</li>
<li>Objects/Stream JSON won't contain holes in the array and actually array indexes in the paths are pretty much ignored. Arrays order depends on the order of the sequence</li>
</ul>
<p>BatchIterable offers other methods to transform the sequence: <a href="https://github.com/sithmel/batch-iterable">map, filter, flatmap, drop, take</a> and many more!</p>
<h3 id="filter-the-sequence-efficiently" class="tsd-anchor-link">filter the sequence efficiently<a href="#filter-the-sequence-efficiently" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p><em>includes</em> allows to select what paths we want to read and filter out the others. It is much faster then using regular <strong>filter</strong> because it stops parsing the stream if no further matches are possible. Here is an example (using the same JSON):</p>
<pre><code class="js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">&#39;&quot;invoices&quot; ( 0..2 (&quot;productName&quot;))&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">)</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<p>This will print:</p>
<pre><code class="js"><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-3">&#39;piano catapult&#39;</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-3">&#39;fake tunnel&#39;</span>
</code><button type="button">Copy</button></pre>

<p>More about <a href="#includes">includes</a> syntax below!</p>
<h3 id="buffer-position" class="tsd-anchor-link">Buffer position<a href="#buffer-position" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>The sequence yields 2 extra numbers. They are the starting and ending position of the buffer, corresponding to the value that is emitting.
So for example, with the JSON we used so far:</p>
<pre><code class="js"><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">includes</span><span class="hl-1">(</span><span class="hl-3">&#39;&quot;invoices&quot; ( 0..2 (&quot;productName&quot;))&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">  .</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">, </span><span class="hl-2">start</span><span class="hl-1">, </span><span class="hl-2">end</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">, </span><span class="hl-2">start</span><span class="hl-1">, </span><span class="hl-2">end</span><span class="hl-1">)</span><br/><span class="hl-1">  })</span><br/><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<p>This will print:</p>
<pre><code class="js"><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-3">&#39;piano catapult&#39;</span><span class="hl-1"> </span><span class="hl-8">38</span><span class="hl-1"> </span><span class="hl-8">54</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-3">&#39;fake tunnel&#39;</span><span class="hl-1"> </span><span class="hl-8">112</span><span class="hl-1"> </span><span class="hl-8">125</span>
</code><button type="button">Copy</button></pre>

<p>Once the position of a value is known, is possible for example:</p>
<ul>
<li>to index where the data is in the buffer and access them directly</li>
<li>to pause and resume the parsing from that position in the buffer</li>
</ul>
<p>It is possible to resume the parsing using the option <code>startingPath</code>.
So for example, let's say we want to resume reading from &quot;piano catapult&quot;:</p>
<pre><code class="js"><span class="hl-7">// the buffer starts with the position 54</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">readStream</span><span class="hl-1"> = </span><span class="hl-2">fs</span><span class="hl-1">.</span><span class="hl-6">createReadStream</span><span class="hl-1">(</span><span class="hl-2">JSONPath</span><span class="hl-1">, { </span><span class="hl-2">start:</span><span class="hl-1"> </span><span class="hl-8">38</span><span class="hl-1"> })</span><br/><br/><span class="hl-7">// the starting path is last path yielded</span><br/><span class="hl-0">await</span><span class="hl-1"> </span><span class="hl-6">streamToIterable</span><span class="hl-1">(</span><span class="hl-2">readStream</span><span class="hl-1">, {</span><br/><span class="hl-1">  </span><span class="hl-2">startingPath:</span><span class="hl-1"> [</span><span class="hl-3">&quot;invoices&quot;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-3">&quot;productName&quot;</span><span class="hl-1">],</span><br/><span class="hl-1">}).</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">)</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-2">readStream</span><span class="hl-1">.</span><span class="hl-6">destroy</span><span class="hl-1">()</span>
</code><button type="button">Copy</button></pre>

<h2 id="objecttoiterable" class="tsd-anchor-link">objectToIterable<a href="#objecttoiterable" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>This is a version of streamToIterable that takes an object as input. Instead of a stream. It was implemented mainly to be used as a mock and reference implementation.</p>
<pre><code class="js"><span class="hl-6">objectToIterable</span><span class="hl-1">({.. a regular object ...})</span><br/><span class="hl-1">  .</span><span class="hl-6">forEach</span><span class="hl-1">(([</span><span class="hl-2">path</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">]) </span><span class="hl-4">=&gt;</span><span class="hl-1"> </span><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">path</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">, </span><span class="hl-2">value</span><span class="hl-1">.</span><span class="hl-2">decoded</span><span class="hl-1">))</span>
</code><button type="button">Copy</button></pre>

<p>It supports all features of <code>streamToIterable</code> with the exceptions:</p>
<ul>
<li>startingPath is not a valid option</li>
<li>the output consists in a single asyncIterable item containing 1 iterable</li>
<li>start position and end position are not yielded</li>
</ul>
<h2 id="sequencetoobject" class="tsd-anchor-link">SequenceToObject<a href="#sequencetoobject" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>SequenceToObject reconstructs an object from a sequence.</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">SequenceToObject</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">objBuilder</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-6">SequenceToObject</span><span class="hl-1">()</span><br/><span class="hl-2">objBuilder</span><span class="hl-1">.</span><span class="hl-6">add</span><span class="hl-1">([</span><span class="hl-3">&quot;hello&quot;</span><span class="hl-1">], </span><span class="hl-3">&quot;world&quot;</span><span class="hl-1">)</span><br/><br/><span class="hl-2">console</span><span class="hl-1">.</span><span class="hl-6">log</span><span class="hl-1">(</span><span class="hl-2">objBuilder</span><span class="hl-1">.</span><span class="hl-6">getObject</span><span class="hl-1">())</span>
</code><button type="button">Copy</button></pre>

<p>This prints:</p>
<pre><code><span class="hl-1">{ </span><span class="hl-13">hello</span><span class="hl-1">: </span><span class="hl-3">&quot;world&quot;</span><span class="hl-1"> }</span>
</code><button>Copy</button></pre>

<p>This is used when working with <code>for loop</code> in specific cases when the <code>toObject</code> method is not an option (see the <a href="#rendering-partial-state">example for rendering the partial state</a>).</p>
<h2 id="utilities" class="tsd-anchor-link">Utilities<a href="#utilities" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><h3 id="getpathmatcher" class="tsd-anchor-link">getPathMatcher<a href="#getpathmatcher" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>This utility converts a string in a data structure used to filter paths. This is used internally but is also exposed to be used for debugging, ensure that the include syntax is correct, and reformat the includes expression.</p>
<pre><code class="js"><span class="hl-0">import</span><span class="hl-1"> { </span><span class="hl-2">getPathMatcher</span><span class="hl-1"> } </span><span class="hl-0">from</span><span class="hl-1"> </span><span class="hl-3">&quot;jsonaut&quot;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-5">matcher</span><span class="hl-1"> = </span><span class="hl-6">getPathMatcher</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-3">`</span><br/><span class="hl-3">&quot;A&quot;(</span><br/><span class="hl-3">  &quot;B&quot;(</span><br/><span class="hl-3">    &quot;C&quot; # test comment 1</span><br/><span class="hl-3">    &quot;D&quot;</span><br/><span class="hl-3">  ) # test comment 2</span><br/><span class="hl-3">  &quot;E&quot; </span><br/><span class="hl-3">)</span><br/><span class="hl-3">&quot;F&quot;</span><br/><span class="hl-3">`</span><span class="hl-1">,</span><br/><span class="hl-1">) </span><span class="hl-7">// this returns a matcher object</span><br/><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">maxLength</span><span class="hl-1">() </span><span class="hl-7">// this is the minimum length of the path to be matched. It cannot be greater than the maxDepth parameter (no matches are possible that way)</span><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">doesMatch</span><span class="hl-1">([</span><span class="hl-3">&quot;A&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;B&quot;</span><span class="hl-1">]) </span><span class="hl-7">// this matches</span><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">doesMatch</span><span class="hl-1">([</span><span class="hl-3">&quot;F&quot;</span><span class="hl-1">, </span><span class="hl-3">&quot;B&quot;</span><span class="hl-1">]) </span><span class="hl-7">// this matches</span><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">doesMatch</span><span class="hl-1">([</span><span class="hl-3">&quot;X&quot;</span><span class="hl-1">]) </span><span class="hl-7">// this doesn&#39;t match</span><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">isExhausted</span><span class="hl-1">() </span><span class="hl-7">// this is now false</span><br/><span class="hl-7">// As no match is possible since A and F have passed</span><br/><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">() </span><span class="hl-7">// this returns: &quot;&#39;A&#39;(&#39;B&#39;(&#39;C&#39; &#39;D&#39;) &#39;E&#39;) &#39;F&#39;&quot;</span><br/><br/><span class="hl-2">matcher</span><span class="hl-1">.</span><span class="hl-6">stringify</span><span class="hl-1">(</span><span class="hl-3">&quot;  &quot;</span><span class="hl-1">) </span><span class="hl-7">// this returns an nicely indented version (2 spaces indentation)</span>
</code><button type="button">Copy</button></pre>

<p>Note: The compact version of the expression (returned by stringify without arguments) has been designed to be passed as query parameter minimising the characters encoded (only the spaces), so that <code>'A'('B'('C' 'D') 'E') 'F'</code> becomes:
<code>'A'('B'('C'%20'D')%20'E')%20'F'</code>.</p>
<h3 id="tovalueobject" class="tsd-anchor-link">toValueObject<a href="#tovalueobject" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>It transform a JS value into an appropriate <a href="#json-values">value object</a>.</p>
<h3 id="topathobject" class="tsd-anchor-link">toPathObject<a href="#topathobject" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h3><p>It transform a JSON path into a <a href="#json-path">path object</a>.</p>
<h2 id="includes" class="tsd-anchor-link">Includes<a href="#includes" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h2><p>The <em>includes</em> method can be used to only emit pairs with a certain path.
This is more limited than a simple filter, but it is able to figure out when matches are no longer possible so that it is not necessary to parse the rest of the JSON.
If more complex filtering is required, is easy enough to filter the sequence once is emitted.
It uses a simple and compact expression to perform matches. Including:</p>
<ul>
<li>direct match of object keys. Using a string enclosed in single or double quotes</li>
<li>direct match of array indices. Using a number</li>
<li>a way to match a slice of an array. Using 2 indices separated by 2 dots: 3..5 (matching index 3 and 4). If the first index is omitted is considered 0, if the last is omitted is considered Infinity</li>
<li>a convenient * operator that matches any index or key as long as there is one</li>
<li>'()' to recursively match on multiple levels</li>
</ul>
<p>It is easier to show. Here's the JSON example:</p>
<pre><code class="json"><span class="hl-1">{</span><br/><span class="hl-1">  </span><span class="hl-9">&quot;products&quot;</span><span class="hl-1">: {</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;123001&quot;</span><span class="hl-1"> : {</span><span class="hl-9">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;piano catapult&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;brand&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;ACME&quot;</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-9">&quot;456001&quot;</span><span class="hl-1"> : {</span><span class="hl-9">&quot;productName&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;fake tunnel&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;brand&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;ACME&quot;</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-10">...</span><br/><span class="hl-1">  },</span><br/><span class="hl-1">  </span><span class="hl-9">&quot;invoices&quot;</span><span class="hl-1">: [</span><br/><span class="hl-1">    {</span><span class="hl-9">&quot;productCode&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;123001&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">40</span><span class="hl-1">, </span><span class="hl-9">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">120</span><span class="hl-1">},</span><br/><span class="hl-1">    {</span><span class="hl-9">&quot;productCode&quot;</span><span class="hl-1">: </span><span class="hl-3">&quot;456001&quot;</span><span class="hl-1">, </span><span class="hl-9">&quot;itemsSold&quot;</span><span class="hl-1">: </span><span class="hl-8">12</span><span class="hl-1">, </span><span class="hl-9">&quot;unitPrice&quot;</span><span class="hl-1">: </span><span class="hl-8">220</span><span class="hl-1">},</span><br/><span class="hl-1">    </span><span class="hl-10">...</span><br/><span class="hl-1">  ]</span><br/><span class="hl-1">}</span>
</code><button type="button">Copy</button></pre>

<p>We can use this expression:</p>
<pre><code><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-8">0..2</span><span class="hl-1">(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;itemsSold&#39;</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;unitPrice&#39;</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>

<p>to get this sequence:</p>
<pre><code><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-3">&#39;itemsSold&#39;</span><span class="hl-1">] </span><span class="hl-8">40</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">0</span><span class="hl-1">, </span><span class="hl-3">&#39;unitPrice&#39;</span><span class="hl-1">] </span><span class="hl-8">120</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-3">&#39;itemsSold&#39;</span><span class="hl-1">] </span><span class="hl-8">12</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;invoices&#39;</span><span class="hl-1">, </span><span class="hl-8">1</span><span class="hl-1">, </span><span class="hl-3">&#39;unitPrice&#39;</span><span class="hl-1">] </span><span class="hl-8">220</span>
</code><button>Copy</button></pre>

<p>or</p>
<pre><code><span class="hl-3">&#39;products&#39;</span><span class="hl-1">(</span><br/><span class="hl-1">  *(</span><br/><span class="hl-1">    </span><span class="hl-3">&#39;productName&#39;</span><br/><span class="hl-1">  )</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>

<p>to get this sequence:</p>
<pre><code><span class="hl-1">[</span><span class="hl-3">&#39;products&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;123001&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-2">piano</span><span class="hl-1"> </span><span class="hl-2">catapult</span><br/><span class="hl-1">[</span><span class="hl-3">&#39;products&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;456001&#39;</span><span class="hl-1">, </span><span class="hl-3">&#39;productName&#39;</span><span class="hl-1">] </span><span class="hl-2">fake</span><span class="hl-1"> </span><span class="hl-2">tunnel</span>
</code><button>Copy</button></pre>

<h1 id="benchmarks" class="tsd-anchor-link">Benchmarks<a href="#benchmarks" aria-label="Permalink" class="tsd-anchor-icon"><svg viewBox="0 0 24 24" aria-hidden="true"><use href="assets/icons.svg#icon-anchor"></use></svg></a></h1><p>I have included benchmarks to show how this library can speed up extracting data from a JSON.
In the examples I am extracting a single random record from a JSON with more than 16000 records (15MB).
As a reference I am comparing to reading the entire file and parsing with JSON.parse:</p>
<pre><code><span class="hl-2">$</span><span class="hl-1"> </span><span class="hl-2">node</span><span class="hl-1"> </span><span class="hl-2">benchmarks</span><span class="hl-1">/</span><span class="hl-2">standardFetch</span><span class="hl-1">.</span><span class="hl-2">mjs</span><br/><br/><span class="hl-2">Timings</span><br/><span class="hl-1">=======</span><br/><span class="hl-13">Mean</span><span class="hl-1">:   </span><span class="hl-8">43.39</span><span class="hl-1"> </span><span class="hl-2">ms</span><br/><span class="hl-13">Median</span><span class="hl-1">: </span><span class="hl-8">41.757</span><span class="hl-1"> </span><span class="hl-2">ms</span><br/><br/><span class="hl-2">Heap</span><br/><span class="hl-1">====</span><br/><span class="hl-13">Mean</span><span class="hl-1">:   </span><span class="hl-8">65</span><span class="hl-1">,</span><span class="hl-8">447.201</span><span class="hl-1"> </span><span class="hl-5">KB</span><br/><span class="hl-13">Median</span><span class="hl-1">: </span><span class="hl-8">65</span><span class="hl-1">,</span><span class="hl-8">295.816</span><span class="hl-1"> </span><span class="hl-5">KB</span>
</code><button>Copy</button></pre>

<p>JSON.parse is really fast! But reading the entire file is really problematic from the point of view of memory management.</p>
<p>Here's how it works using StreamToSequence streaming parser with maxDepth and includes:</p>
<pre><code><span class="hl-2">$</span><span class="hl-1"> </span><span class="hl-2">node</span><span class="hl-1"> </span><span class="hl-2">benchmarks</span><span class="hl-1">/</span><span class="hl-2">efficientFetch</span><span class="hl-1">.</span><span class="hl-2">mjs</span><br/><br/><span class="hl-2">Timings</span><br/><span class="hl-1">=======</span><br/><span class="hl-13">Mean</span><span class="hl-1">:   </span><span class="hl-8">29.934</span><span class="hl-1"> </span><span class="hl-2">ms</span><br/><span class="hl-13">Median</span><span class="hl-1">: </span><span class="hl-8">28.89</span><span class="hl-1"> </span><span class="hl-2">ms</span><br/><br/><span class="hl-2">Heap</span><br/><span class="hl-1">====</span><br/><span class="hl-13">Mean</span><span class="hl-1">:   </span><span class="hl-8">6</span><span class="hl-1">,</span><span class="hl-8">138.229</span><span class="hl-1"> </span><span class="hl-5">KB</span><br/><span class="hl-13">Median</span><span class="hl-1">: </span><span class="hl-8">5</span><span class="hl-1">,</span><span class="hl-8">955.203</span><span class="hl-1"> </span><span class="hl-5">KB</span>
</code><button>Copy</button></pre>

<p>It is a little bit faster (not having to read the entire file every time). But also much more memory efficient.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-accordion"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><span class="settings-label">Member Visibility</span><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></div><div class="tsd-theme-toggle"><label class="settings-label" for="tsd-theme">Theme</label><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><svg width="20" height="20" viewBox="0 0 24 24" fill="none" aria-hidden="true"><use href="assets/icons.svg#icon-chevronDown"></use></svg><h3>On This Page</h3></summary><div class="tsd-accordion-details"><ul><li><a href="#index"><span>Index</span></a></li><li><a href="#examples"><span>Examples</span></a></li><li><ul><li><a href="#parsing-a-subset-of-a-json"><span>Parsing a subset of a <wbr/>JSON</span></a></li><li><a href="#filtering-a-json-stream"><span>Filtering a <wbr/>JSON stream</span></a></li><li><a href="#transform-json-stream"><span>Transform <wbr/>JSON stream</span></a></li><li><a href="#rendering-partial-state"><span>Rendering partial state</span></a></li><li><a href="#index-a-json-and-load-a-json-fragment"><span>Index a <wbr/>JSON and load a <wbr/>JSON fragment</span></a></li></ul></li></ul><a href="#main-concepts"><span>Main concepts</span></a><ul><li><a href="#path-value"><span>Path, <wbr/>Value</span></a></li><li><a href="#batchiterable"><span>Batch<wbr/>Iterable</span></a></li><li><a href="#path-and-value-encodingdecoding"><span>Path and <wbr/>Value encoding/decoding</span></a></li><li><ul><li><a href="#json-values"><span>JSON <wbr/>Values</span></a></li><li><a href="#json-path"><span>JSON <wbr/>Path</span></a></li><li><a href="#how-to-use-it"><span>How to use it</span></a></li></ul></li></ul><a href="#functions-and-classes"><span>Functions and <wbr/>Classes</span></a><ul><li><a href="#streamtoiterable"><span>stream<wbr/>To<wbr/>Iterable</span></a></li><li><ul><li><a href="#maxdepth-and-ismaxdepthreached"><span>max<wbr/>Depth and is<wbr/>Max<wbr/>Depth<wbr/>Reached</span></a></li><li><a href="#transform-the-sequence"><span>Transform the sequence</span></a></li><li><a href="#filter-the-sequence-efficiently"><span>filter the sequence efficiently</span></a></li><li><a href="#buffer-position"><span>Buffer position</span></a></li></ul></li><li><a href="#objecttoiterable"><span>object<wbr/>To<wbr/>Iterable</span></a></li><li><a href="#sequencetoobject"><span>Sequence<wbr/>To<wbr/>Object</span></a></li><li><a href="#utilities"><span>Utilities</span></a></li><li><ul><li><a href="#getpathmatcher"><span>get<wbr/>Path<wbr/>Matcher</span></a></li><li><a href="#tovalueobject"><span>to<wbr/>Value<wbr/>Object</span></a></li><li><a href="#topathobject"><span>to<wbr/>Path<wbr/>Object</span></a></li></ul></li><li><a href="#includes"><span>Includes</span></a></li></ul><a href="#benchmarks"><span>Benchmarks</span></a></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html">jsonaut</a><ul class="tsd-small-nested-navigation" id="tsd-nav-container"><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>
